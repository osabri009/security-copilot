openapi: 3.0.0

info:
  title: FortiAnalyzer Logs API
  description: Retrieve log data from FortiAnalyzer
  version: "v1"

servers:
  - url: https://<your-fortianalyzer-url>/api/v2

paths:
  /logs:
    get:
      operationId: getLogs
      summary: Retrieve logs from FortiAnalyzer
      parameters:
        - in: query
          name: ipAddress
          schema:
            type: string
          required: false
          description: Filter logs by IP address.
        - in: query
          name: logType
          schema:
            type: string
            enum: [traffic, security, system]
          required: false
          description: Filter logs by type (e.g., traffic, security).
        - in: query
          name: startTime
          schema:
            type: string
            format: date-time
          required: false
          description: Start time for filtering logs.
        - in: query
          name: endTime
          schema:
            type: string
            format: date-time
          required: false
          description: End time for filtering logs.
      responses:
        "200":
          description: A list of log entries
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LogResponse"

components:
  schemas:
    LogResponse:
      type: object
      properties:
        logs:
          type: array
          items:
            type: object
            properties:
              logId:
                type: string
                description: Unique identifier of the log entry.
              timestamp:
                type: string
                format: date-time
                description: Timestamp of the log entry.
              ipAddress:
                type: string
                description: IP address associated with the log entry.
              logType:
                type: string
                description: Type of log (e.g., traffic, security, system).
              details:
                type: string
                description: Details of the log entry.
